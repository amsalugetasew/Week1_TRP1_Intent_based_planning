<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Analyzer - Web-based Data Analysis Tool</title>
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Application Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-file-earmark-spreadsheet me-2"></i>
                Excel Analyzer
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#upload" data-section="upload">Upload</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#preview" data-section="preview">Preview</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#analyze" data-section="analyze">Analyze</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#dashboard" data-section="dashboard">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#export" data-section="export">Export</a>
                    </li>
                </ul>
                <div class="d-flex align-items-center gap-2">
                    <button id="themeToggle" class="btn btn-sm btn-outline-light" type="button" title="Toggle Theme">
                        <i class="bi bi-moon-stars"></i>
                    </button>
                    <span class="navbar-text d-none d-lg-inline">
                        Client-side processing - Your data stays private
                    </span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container my-4">
        <!-- File Upload Section -->
        <section id="upload" class="upload-section mb-4">
            <div class="card">
                <div class="card-header">
                    <h2 class="mb-0">
                        <i class="bi bi-upload"></i>
                        Upload Excel File
                    </h2>
                </div>
                <div class="card-body">
                    <div id="dropZone" class="drop-zone text-center p-4 border border-dashed rounded">
                        <div class="drop-zone-content">
                            <i class="bi bi-file-earmark-excel display-4 text-muted mb-3"></i>
                            <h5>Drag and drop your Excel file here</h5>
                            <p class="text-muted">or</p>
                            <input type="file" id="fileInput" accept=".xlsx,.xls" class="form-control" style="display: none;">
                            <button type="button" id="selectFileBtn" class="btn btn-primary">
                                Select File
                            </button>
                        </div>
                    </div>
                    
                    <div id="fileInfo" class="mt-3" style="display: none;">
                        <div class="row">
                            <div class="col-md-6">
                                <strong>File:</strong> <span id="fileName"></span>
                            </div>
                            <div class="col-md-6">
                                <strong>Size:</strong> <span id="fileSize"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="uploadProgress" class="progress mt-3" style="display: none;">
                        <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                    
                    <div id="uploadStatus" class="mt-3"></div>
                </div>
            </div>
        </section>

        <!-- Data Preview Section -->
        <section id="preview" class="preview-section mb-4" style="display: none;">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h2 class="mb-0">
                        <i class="bi bi-table"></i>
                        Data Preview
                    </h2>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-outline-primary" id="btnFirst100">First 100 Rows</button>
                        <button type="button" class="btn btn-outline-primary" id="btnAllData">All Data</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Total Rows</h6>
                                    <h3 class="text-primary" id="totalRows">0</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Total Columns</h6>
                                    <h3 class="text-primary" id="totalCols">0</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Missing Values</h6>
                                    <h3 class="text-warning" id="missingValues">0</h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-title">Data Quality</h6>
                                    <h3 class="text-success" id="dataQuality">100%</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover" id="dataTable">
                            <thead id="tableHeader">
                            </thead>
                            <tbody id="tableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analysis Section -->
        <section id="analyze" class="analyze-section mb-4" style="display: none;">
            <div class="card">
                <div class="card-header">
                    <h2 class="mb-0">
                        <i class="bi bi-bar-chart"></i>
                        Data Analysis
                    </h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5>Column Analysis</h5>
                                </div>
                                <div class="card-body">
                                    <div id="columnAnalysis"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5>Chart Selection</h5>
                                    <select id="chartTypeSelector" class="form-select" style="width: auto;">
                                        <option value="auto">Auto Select</option>
                                        <option value="bar">Bar Chart</option>
                                        <option value="line">Line Chart</option>
                                        <option value="pie">Pie Chart</option>
                                        <option value="scatter">Scatter Plot</option>
                                    </select>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="xAxisSelector" class="form-label">X-Axis</label>
                                            <select id="xAxisSelector" class="form-select"></select>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="yAxisSelector" class="form-label">Y-Axis</label>
                                            <select id="yAxisSelector" class="form-select"></select>
                                        </div>
                                    </div>
                                    <div class="mt-3">
                                        <canvas id="analysisChart" width="400" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="dashboard-section mb-4" style="display: none;">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h2 class="mb-0">
                        <i class="bi bi-columns"></i>
                        Interactive Dashboard
                    </h2>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-outline-secondary" id="layout1">Layout 1</button>
                        <button type="button" class="btn btn-outline-secondary" id="layout2">Layout 2</button>
                        <button type="button" class="btn btn-outline-secondary" id="layout3">Layout 3</button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="dashboard-grid" id="dashboardGrid">
                        <!-- Dashboard widgets will be added here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Export Section -->
        <section id="export" class="export-section mb-4" style="display: none;">
            <div class="card">
                <div class="card-header">
                    <h2 class="mb-0">
                        <i class="bi bi-download"></i>
                        Export Results
                    </h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <i class="bi bi-file-pdf display-4 text-danger mb-3"></i>
                                    <h5>PDF Report</h5>
                                    <p class="text-muted">Export analysis with charts</p>
                                    <button class="btn btn-danger" id="exportPDF">
                                        <i class="bi bi-download"></i> Download PDF
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <i class="bi bi-file-earmark-excel display-4 text-success mb-3"></i>
                                    <h5>Excel File</h5>
                                    <p class="text-muted">Export processed data</p>
                                    <button class="btn btn-success" id="exportExcel">
                                        <i class="bi bi-download"></i> Download Excel
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <i class="bi bi-image display-4 text-info mb-3"></i>
                                    <h5>Chart Images</h5>
                                    <p class="text-muted">Export individual charts</p>
                                    <button class="btn btn-info" id="exportCharts">
                                        <i class="bi bi-download"></i> Export Charts
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <div class="progress" id="exportProgress" style="display: none;">
                            <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                        </div>
                        <div id="exportStatus" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>Excel Analyzer</h5>
                    <p>A powerful web-based tool for Excel data analysis and visualization.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p>&copy; 2026 Excel Analyzer. All rights reserved.</p>
                    <p class="small text-muted">Client-side processing ensures your data privacy</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    
    <!-- Application Scripts -->
    <script src="js/config/defaults.js"></script>
    <script src="js/config/themes.js"></script>
    <script src="js/config/settings.js"></script>
    <script src="js/modules/file-upload.js"></script>
    <script src="js/modules/data-processor.js"></script>
    <script src="js/modules/visualizer.js"></script>
    <script src="js/modules/dashboard.js"></script>
    <script src="js/modules/exporter.js"></script>
    <script src="js/modules/notifications.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/utils/validators.js"></script>
    <script src="js/utils/formatters.js"></script>
    <script src="js/events/event-system.js"></script>
    <script src="js/events/event-handlers.js"></script>
    <script src="js/main.js"></script>
</body>
</html>